<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <title>감다살 첼린지 영상 아카이브</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      :root {
        color-scheme: light dark;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        min-height: 100vh;
        font-family: 'Pretendard', 'Apple SD Gothic Neo', 'Segoe UI', sans-serif;
        color: #f7f4ff;
        background: radial-gradient(circle at 20% 20%, #04020c 0%, #120c2c 45%, #010008 100%);
        display: flex;
        justify-content: center;
        padding: clamp(2rem, 5vw, 3.5rem) clamp(1.5rem, 4vw, 3rem);
      }
      main {
        width: min(820px, 100%);
        display: grid;
        gap: clamp(2rem, 5vw, 3rem);
        background: rgba(17, 15, 36, 0.78);
        border-radius: clamp(2rem, 4vw, 3rem);
        padding: clamp(2.4rem, 5vw, 3.6rem);
        box-shadow: 0 3rem 5rem rgba(0, 0, 0, 0.55), inset 0 0 0 1px rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(18px);
      }
      header {
        text-align: center;
        display: grid;
        gap: 0.8rem;
      }
      header h1 {
        margin: 0;
        font-size: clamp(2.4rem, 6vw, 3.4rem);
        letter-spacing: 0.05em;
      }
      header p {
        margin: 0;
        color: rgba(255, 255, 255, 0.75);
        font-size: 1.05rem;
      }
      section {
        display: grid;
        gap: 1.2rem;
      }
      .section-title {
        margin: 0;
        font-size: 1rem;
        letter-spacing: 0.18em;
        text-transform: uppercase;
        color: rgba(255, 255, 255, 0.7);
      }
      .upload-list {
        display: grid;
        gap: 1rem;
      }
      .upload-item {
        display: flex;
        gap: 1.2rem;
        flex-wrap: wrap;
        align-items: center;
        padding: 1rem 1.2rem;
        border-radius: 1.4rem;
        background: rgba(255, 255, 255, 0.08);
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.12);
      }
      .upload-video {
        flex: 0 0 200px;
        max-width: 240px;
        border-radius: 1.2rem;
        overflow: hidden;
        box-shadow: 0 1rem 2rem rgba(0, 0, 0, 0.45);
      }
      .upload-video video {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover;
        background: rgba(0, 0, 0, 0.35);
      }
      .upload-info {
        flex: 1 1 220px;
        text-align: left;
      }
      .upload-info strong {
        display: block;
        font-size: 1.05rem;
        color: #ffe7f8;
      }
      .upload-info span {
        font-size: 0.92rem;
        color: rgba(255, 255, 255, 0.68);
      }
      .upload-actions {
        display: flex;
        gap: 0.6rem;
        align-items: center;
      }
      .upload-actions button {
        border: none;
        border-radius: 999px;
        padding: 0.5rem 0.9rem;
        font-size: 0.85rem;
        font-weight: 600;
        background: rgba(255, 255, 255, 0.16);
        color: rgba(20, 16, 44, 0.92);
        cursor: pointer;
        transition: filter 0.15s ease;
      }
      .upload-actions button:hover {
        filter: brightness(1.08);
      }
      .upload-empty {
        margin: 0;
        padding: 1rem 1.2rem;
        border-radius: 1.2rem;
        background: rgba(255, 255, 255, 0.06);
        color: rgba(255, 255, 255, 0.65);
      }
      form {
        display: grid;
        gap: 0.9rem;
        padding: 1.6rem 1.8rem;
        border-radius: 1.8rem;
        background: rgba(255, 255, 255, 0.07);
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.08);
      }
      form label {
        text-align: left;
        font-size: 0.95rem;
        color: rgba(255, 255, 255, 0.78);
      }
      form input {
        width: 100%;
        border: none;
        border-radius: 1rem;
        padding: 0.9rem 1rem;
        font-size: 1rem;
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.1);
      }
      form input::placeholder {
        color: rgba(255, 255, 255, 0.55);
      }
      form input:focus {
        outline: 2px solid rgba(255, 255, 255, 0.28);
      }
      form button {
        justify-self: flex-end;
        border: none;
        border-radius: 999px;
        padding: 0.8rem 1.8rem;
        font-size: 0.95rem;
        font-weight: 600;
        letter-spacing: 0.05em;
        background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
        color: #351d2f;
        cursor: pointer;
        box-shadow: 0 1.4rem 2.4rem rgba(255, 154, 158, 0.32);
      }
      form button:hover {
        filter: brightness(1.04);
      }
      @media (max-width: 640px) {
        body {
          padding: 1.6rem 1.1rem 2.4rem;
        }
        main {
          padding: 2rem 1.4rem 2.6rem;
        }
        .upload-item {
          padding: 0.9rem;
        }
        .upload-video {
          flex: 1 1 100%;
          max-width: none;
        }
        .upload-actions {
          width: 100%;
          justify-content: flex-end;
        }
        form {
          padding: 1.3rem 1.4rem;
        }
      }
    </style>
  </head>
  <body>
    <main>
      <header>
        <h1>감다살 첼린지 영상 아카이브</h1>
        <p>둔산제일감리교회 감다살 셀의 인증 영상을 모아두고 함께 시청하세요.</p>
      </header>

      <section aria-labelledby="upload-list-title">
        <h2 id="upload-list-title" class="section-title">최근 영상</h2>
        <div id="upload-list" class="upload-list"></div>
      </section>

      <section aria-labelledby="upload-form-title">
        <h2 id="upload-form-title" class="section-title">영상 업로드</h2>
        <form id="upload-form" autocomplete="off">
          <label for="upload-title">영상 제목</label>
          <input id="upload-title" type="text" maxlength="80" placeholder="예: 이하연셀 이하연 — 새벽 묵상" required>
          <label for="upload-src">영상 링크 (mp4)</label>
          <input id="upload-src" type="url" placeholder="https://example.com/video.mp4" required>
          <button type="submit">업로드</button>
        </form>
      </section>
    </main>

    <script>
      const DEFAULT_UPLOADS = [
        {
          title: '이하연셀 정요한 — 새벽 큐티 VLOG',
          subtitle: '2025-10-22 · 1분 12초',
          src: 'https://samplelib.com/lib/preview/mp4/sample-5s.mp4',
          poster: 'https://dummyimage.com/320x180/1e1b3f/ffffff&text=%EC%A0%95%EC%9A%94%ED%95%9C+VLOG'
        },
        {
          title: '이하연셀 강민욱 — 찬양 연습 라이브',
          subtitle: '2025-10-21 · 58초',
          src: 'https://samplelib.com/lib/preview/mp4/sample-10s.mp4',
          poster: 'https://dummyimage.com/320x180/2a2558/ffffff&text=%EA%B0%95%EB%AF%BC%EC%9A%B1+LIVE'
        }
      ];
      const STORAGE_KEY = 'gamdasal-challenge-uploads';

      const uploadList = document.getElementById('upload-list');
      const uploadForm = document.getElementById('upload-form');
      const titleInput = document.getElementById('upload-title');
      const srcInput = document.getElementById('upload-src');

      let uploads = [];

      const fallbackPoster = (title) => {
        const safe = encodeURIComponent((title || 'GamdAsal').slice(0, 18));
        return `https://dummyimage.com/320x180/211d44/ffffff&text=${safe}`;
      };

      const formatNow = () => {
        const now = new Date();
        const pad = (value) => String(value).padStart(2, '0');
        return `${now.getFullYear()}-${pad(now.getMonth() + 1)}-${pad(now.getDate())} · ${pad(now.getHours())}:${pad(now.getMinutes())}`;
      };

      const persistUploads = () => {
        try {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(uploads));
        } catch (error) {
          console.error('업로드 저장 실패', error);
        }
      };

      const renderUploads = () => {
        uploadList.innerHTML = '';
        if (!uploads.length) {
          const empty = document.createElement('p');
          empty.className = 'upload-empty';
          empty.textContent = '등록된 영상이 아직 없습니다. 위 양식을 사용해 감다살 첼린지 영상을 공유해 보세요.';
          uploadList.append(empty);
          return;
        }

        uploads.forEach((item, index) => {
          const article = document.createElement('article');
          article.className = 'upload-item';

          const videoWrap = document.createElement('div');
          videoWrap.className = 'upload-video';
          const video = document.createElement('video');
          video.controls = true;
          video.preload = 'metadata';
          video.src = item.src;
          video.poster = item.poster;
          videoWrap.append(video);

          const info = document.createElement('div');
          info.className = 'upload-info';
          const title = document.createElement('strong');
          title.textContent = item.title;
          const subtitle = document.createElement('span');
          subtitle.textContent = item.subtitle;
          info.append(title, subtitle);

          const actions = document.createElement('div');
          actions.className = 'upload-actions';
          const removeBtn = document.createElement('button');
          removeBtn.type = 'button';
          removeBtn.textContent = '삭제';
          removeBtn.dataset.remove = String(index);
          actions.append(removeBtn);

          article.append(videoWrap, info, actions);
          uploadList.append(article);
        });
      };

      const seedUploads = () => {
        try {
          const stored = JSON.parse(localStorage.getItem(STORAGE_KEY) || 'null');
          if (Array.isArray(stored) && stored.length) {
            uploads = stored;
          } else {
            uploads = [...DEFAULT_UPLOADS];
            persistUploads();
          }
        } catch (error) {
          uploads = [...DEFAULT_UPLOADS];
          persistUploads();
        }
        renderUploads();
      };

      uploadList.addEventListener('click', (event) => {
        const target = event.target.closest('button[data-remove]');
        if (!target) return;
        const index = Number(target.dataset.remove);
        if (Number.isNaN(index)) return;
        const confirmRemove = window.confirm('이 영상을 목록에서 삭제할까요?');
        if (!confirmRemove) return;
        uploads.splice(index, 1);
        persistUploads();
        renderUploads();
      });

      uploadForm.addEventListener('submit', (event) => {
        event.preventDefault();
        const title = titleInput.value.trim();
        const src = srcInput.value.trim();
        if (!title || !src) {
          window.alert('영상 제목과 링크를 입력해주세요.');
          return;
        }
        const newItem = {
          title,
          subtitle: formatNow(),
          src,
          poster: fallbackPoster(title)
        };
        uploads.unshift(newItem);
        uploads = uploads.slice(0, 12);
        persistUploads();
        renderUploads();
        uploadForm.reset();
      });

      seedUploads();
    </script>
  </body>
</html>
