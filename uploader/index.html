<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <title>감다살 영상 업로드 도우미</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      :root {
        color-scheme: light dark;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        min-height: 100vh;
        font-family: 'Pretendard', 'Apple SD Gothic Neo', 'Segoe UI', sans-serif;
        color: #f6f4ff;
        background: radial-gradient(circle at 20% 20%, #05020d 0%, #1a0f3f 45%, #010008 100%);
        display: flex;
        justify-content: center;
        padding: clamp(2rem, 5vw, 3.5rem) clamp(1.5rem, 4vw, 3rem);
      }
      main {
        width: min(760px, 100%);
        display: grid;
        gap: clamp(1.8rem, 4vw, 2.8rem);
        background: rgba(18, 14, 40, 0.82);
        border-radius: clamp(2rem, 4vw, 3rem);
        padding: clamp(2.4rem, 5vw, 3.6rem);
        box-shadow: 0 3rem 5rem rgba(0, 0, 0, 0.55), inset 0 0 0 1px rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(18px);
      }
      header {
        text-align: center;
        display: grid;
        gap: 0.8rem;
      }
      header h1 {
        margin: 0;
        font-size: clamp(2.3rem, 6vw, 3.3rem);
        letter-spacing: 0.05em;
      }
      header p {
        margin: 0;
        color: rgba(255, 255, 255, 0.75);
        font-size: 1.05rem;
      }
      section {
        display: grid;
        gap: 1.2rem;
      }
      .section-title {
        margin: 0;
        font-size: 1rem;
        letter-spacing: 0.16em;
        text-transform: uppercase;
        color: rgba(255, 255, 255, 0.7);
      }
      .link-box {
        display: grid;
        gap: 0.7rem;
        padding: 1.4rem 1.6rem;
        border-radius: 1.6rem;
        background: rgba(255, 255, 255, 0.08);
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.1);
      }
      .link-box label {
        font-size: 0.95rem;
        text-align: left;
        color: rgba(255, 255, 255, 0.75);
      }
      .link-input {
        display: flex;
        gap: 0.6rem;
        align-items: center;
      }
      input[type="url"],
      input[type="text"] {
        flex: 1 1 auto;
        border: none;
        border-radius: 0.9rem;
        padding: 0.85rem 1rem;
        font-size: 0.98rem;
        background: rgba(255, 255, 255, 0.12);
        color: #fff;
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.1);
      }
      input::placeholder {
        color: rgba(255, 255, 255, 0.55);
      }
      input:focus {
        outline: 2px solid rgba(255, 255, 255, 0.28);
      }
      button {
        border: none;
        border-radius: 999px;
        padding: 0.75rem 1.6rem;
        font-size: 0.95rem;
        font-weight: 600;
        letter-spacing: 0.04em;
        background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
        color: #341d2f;
        cursor: pointer;
        box-shadow: 0 1.1rem 2.2rem rgba(255, 154, 158, 0.3);
      }
      button:hover {
        filter: brightness(1.04);
      }
      button:disabled {
        opacity: 0.55;
        cursor: default;
        filter: none;
      }
      .dropzone {
        position: relative;
        border: 2px dashed rgba(255, 255, 255, 0.22);
        border-radius: 1.8rem;
        padding: 2rem 1.6rem;
        text-align: center;
        color: rgba(255, 255, 255, 0.75);
        display: grid;
        gap: 0.7rem;
        background: rgba(255, 255, 255, 0.05);
        transition: border-color 0.2s ease, background 0.2s ease;
      }
      .dropzone.dragover {
        border-color: #fad0c4;
        background: rgba(255, 255, 255, 0.12);
      }
      .dropzone input {
        display: none;
      }
      .status-box {
        display: grid;
        gap: 0.5rem;
        padding: 1rem 1.2rem;
        border-radius: 1.2rem;
        background: rgba(255, 255, 255, 0.08);
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.12);
      }
      .status-label {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.72);
      }
      .status-value {
        font-size: 0.95rem;
        color: #ffe7f8;
        word-break: break-all;
      }
      .status-actions {
        display: flex;
        gap: 0.6rem;
      }
      @media (max-width: 600px) {
        body {
          padding: 1.6rem 1.1rem 2.2rem;
        }
        main {
          padding: 2rem 1.4rem 2.4rem;
        }
        .link-input {
          flex-direction: column;
          align-items: stretch;
        }
        button {
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <main>
      <header>
        <h1>감다살 영상 업로드 도우미</h1>
        <p>영상 링크를 모으기 전에 mp4 주소를 확인하거나 새 영상을 업로드할 수 있는 임시 공간입니다.</p>
      </header>

      <section>
        <h2 class="section-title">기존 링크 붙여넣기</h2>
        <div class="link-box">
          <label for="preview-url">mp4 주소를 입력하면 바로 미리보기할 수 있어요.</label>
          <div class="link-input">
            <input id="preview-url" type="url" placeholder="https://example.com/video.mp4">
            <button type="button" id="preview-open">미리보기</button>
          </div>
          <video id="preview-video" controls hidden style="width:100%;border-radius:1.2rem;box-shadow:0 1rem 2rem rgba(0,0,0,0.45);"></video>
        </div>
      </section>

      <section>
        <h2 class="section-title">파일 업로드 (file.io)</h2>
        <div class="dropzone" id="dropzone">
          <div>
            <strong>파일을 끌어다 놓거나 클릭해서 선택하세요.</strong>
          </div>
          <div>최대 100MB, 업로드 완료 후 공유 링크가 생성됩니다. (file.io · 1회 다운로드 후 만료 가능)</div>
          <button type="button" id="file-select">파일 선택</button>
          <input id="file-input" type="file" accept="video/*">
        </div>
        <div class="status-box" id="upload-status" hidden>
          <div class="status-label">업로드 결과</div>
          <div class="status-value" id="upload-message"></div>
          <div class="status-actions" id="upload-actions"></div>
        </div>
      </section>
    </main>

    <script>
      const previewUrlInput = document.getElementById('preview-url');
      const previewButton = document.getElementById('preview-open');
      const previewVideo = document.getElementById('preview-video');

      const dropzone = document.getElementById('dropzone');
      const fileInput = document.getElementById('file-input');
      const fileSelectButton = document.getElementById('file-select');
      const statusBox = document.getElementById('upload-status');
      const statusMessage = document.getElementById('upload-message');
      const statusActions = document.getElementById('upload-actions');

      const openPreview = () => {
        const url = previewUrlInput.value.trim();
        if (!url) {
          alert('미리볼 영상 주소를 입력해주세요.');
          return;
        }
        previewVideo.src = url;
        previewVideo.hidden = false;
        previewVideo.play().catch(() => {});
      };

      previewButton.addEventListener('click', openPreview);
      previewUrlInput.addEventListener('keydown', (event) => {
        if (event.key === 'Enter') {
          event.preventDefault();
          openPreview();
        }
      });

      const resetStatus = () => {
        statusBox.hidden = true;
        statusMessage.textContent = '';
        statusActions.innerHTML = '';
      };

      const showStatus = (message, link) => {
        statusMessage.textContent = message;
        statusActions.innerHTML = '';
        if (link) {
          const linkButton = document.createElement('button');
          linkButton.type = 'button';
          linkButton.textContent = '링크 복사';
          linkButton.addEventListener('click', () => {
            navigator.clipboard.writeText(link).then(() => {
              alert('링크가 클립보드에 복사되었습니다.');
            });
          });
          const openButton = document.createElement('button');
          openButton.type = 'button';
          openButton.textContent = '링크 열기';
          openButton.addEventListener('click', () => {
            window.open(link, '_blank');
          });
          statusActions.append(linkButton, openButton);
        }
        statusBox.hidden = false;
      };

      const uploadToFileIO = async (file) => {
        resetStatus();
        showStatus('업로드 중입니다… 잠시만 기다려주세요.');
        const formData = new FormData();
        formData.append('file', file);
        try {
          const response = await fetch('https://file.io/?json=true&expires=1w', {
            method: 'POST',
            body: formData,
          });
          if (!response.ok) {
            throw new Error('HTTP ' + response.status);
          }
          const result = await response.json();
          if (!result.success) {
            throw new Error(result.message || '업로드 실패');
          }
          showStatus(`업로드 완료! (만료: ${result.expiry || '1회 다운로드'})`, result.link);
        } catch (error) {
          console.error(error);
          showStatus('업로드에 실패했습니다. 잠시 후 다시 시도해주세요.');
        }
      };

      const handleFile = (file) => {
        if (!file) return;
        if (!file.type.startsWith('video/')) {
          alert('영상 파일만 업로드할 수 있습니다.');
          return;
        }
        uploadToFileIO(file);
      };

      fileSelectButton.addEventListener('click', () => fileInput.click());
      fileInput.addEventListener('change', (event) => {
        const [file] = event.target.files;
        handleFile(file);
        fileInput.value = '';
      });

      ['dragenter', 'dragover'].forEach((type) => {
        dropzone.addEventListener(type, (event) => {
          event.preventDefault();
          dropzone.classList.add('dragover');
        });
      });

      ['dragleave', 'drop'].forEach((type) => {
        dropzone.addEventListener(type, (event) => {
          event.preventDefault();
          dropzone.classList.remove('dragover');
        });
      });

      dropzone.addEventListener('drop', (event) => {
        const file = event.dataTransfer.files[0];
        handleFile(file);
      });
    </script>
  </body>
</html>
